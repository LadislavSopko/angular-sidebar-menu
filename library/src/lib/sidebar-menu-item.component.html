<div
  class="asm-menu__item"
  routerLinkActive="asm-menu__item--active"
  [routerLinkActiveOptions]="{ exact: true }"
  [ngClass]="{
    'asm-menu__item--open': !!menuItem.children && isOpen,
    'asm-menu__item--active': !!menuItem.children && isActiveChild
  }"
>
  <span *ngIf="menuItem.header" class="asm-menu__item__header">{{ menuItem.header }}</span>
  <a *ngIf="menuItem.route || menuItem.route === ''" [routerLink]="menuItem.route">
    <ng-container *ngTemplateOutlet="innerItem; context: { $implicit: menuItem }"></ng-container>
  </a>
  <a *ngIf="menuItem.url" [href]="menuItem.url" [target]="menuItem.target">
    <ng-container *ngTemplateOutlet="innerItem; context: { $implicit: menuItem }"></ng-container>
  </a>
  <ng-container *ngIf="menuItem.children">
    <a (click)="onNodeToggleClick()">
      <ng-container *ngTemplateOutlet="innerItem; context: { $implicit: menuItem }"></ng-container>
    </a>
    <ul class="asm-menu__item__node" [@openClose]="isOpen">
      <li
        *ngFor="let childItem of menuItem.children"
        [asm-sidebar-menu-item]="childItem"
        [iconClasses]="iconClasses"
        [toggleIconClasses]="toggleIconClasses"
        (isItemActive)="isChildItemActive($event)"
        [isRootNode]="false"
      ></li>
    </ul>
  </ng-container>
</div>

<ng-template #innerItem let-menuItem>
  <ng-container *ngIf="asMenuItem(menuItem) as menuItem">
    <i *ngIf="menuItem.iconClasses || iconClasses" [class]="menuItem.iconClasses || iconClasses" class="asm-menu__item__icon"></i>
    <span class="asm-menu__item__label">{{ menuItem.label }}</span>
    <span
      *ngIf="menuItem.badges || menuItem.children"
      class="asm-menu__item__pull"
      [ngClass]="{ 'asm-badges': menuItem.badges, 'asm-toggle': menuItem.children }"
    >
      <i *ngIf="menuItem.children" [class]="toggleIconClasses" [@rotate]="isOpen" class="asm-toggle__icon"></i>
      <span *ngFor="let badge of menuItem.badges" [class]="badge.classes" class="asm-badges__badge">{{ badge.label }}</span>
    </span>
  </ng-container>
</ng-template>
